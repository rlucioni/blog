<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>S3 Deployment withÂ Travis</title>
        <meta name="description" content="How to use Travis to deploy to S3.">

        <style type="text/css">
*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;-ms-box-sizing:border-box;-o-box-sizing:border-box;box-sizing:border-box}html,body{margin:0;padding:0}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:300;font-size:16px;line-height:1.5}@media (min-width: 58em){html{font-size:20px}}body{color:rgba(0,0,0,0.87);background-color:#fff;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizeLegibility}a{color:rgba(33,150,243,0.87);text-decoration:none;-webkit-transition:color 250ms ease;-moz-transition:color 250ms ease;-ms-transition:color 250ms ease;-o-transition:color 250ms ease;transition:color 250ms ease}a strong{color:inherit}a:hover,a:focus{color:rgba(43,90,172,0.87)}h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:400;line-height:1.25}h1{font-size:2rem}h2{margin-top:1rem;font-size:1.5rem}h3{margin-top:1.5rem;font-size:1.25rem}h4,h5,h6{margin-top:1rem;font-size:1rem}p{margin-top:0;margin-bottom:1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}dt{font-weight:400}dd{margin-bottom:.5rem}.list-unstyled{padding-left:0;list-style:none}code,pre{font-family:"SFMono-Regular",Consolas,"Liberation Mono",Menlo,Courier,monospace;text-rendering:optimizeSpeed}code{font-weight:700;font-size:90%}pre{font-weight:400;display:block;margin-top:0;margin-bottom:1rem;padding:1rem;font-size:.8rem;line-height:1.4;overflow:auto;word-wrap:normal;white-space:pre;background-color:rgba(0,0,0,0.05)}pre code{padding:0;font-size:100%;color:inherit;background-color:transparent}blockquote{padding:.5rem 1rem;margin:.8rem 0;color:rgba(0,0,0,0.54);border-left:0.25rem solid rgba(0,0,0,0.12)}blockquote p:last-child{margin-bottom:0}@media (min-width: 30em){blockquote{padding-right:5rem;padding-left:1.25rem}}img,video{display:block;max-width:100%;margin:0 0 1rem}table{margin-bottom:1rem;width:100%;background-color:transparent;border-collapse:collapse}th,td{padding:0.3rem;vertical-align:top;border-top:1px solid #eceeef;text-align:left}.rows th{width:30%}.rows td{width:70%}.rows tr:first-child th,.rows tr:first-child td{border-top:none}hr{position:relative;margin:1.5rem 0;border:0;border-top:1px solid rgba(0,0,0,0.12);border-bottom:1px solid #fff}abbr{font-size:85%;font-weight:400;color:rgba(0,0,0,0.87);text-transform:uppercase}abbr[title]{cursor:help;border-bottom:1px dotted rgba(0,0,0,0.12)}.lead{margin-bottom:1rem;font-size:1.2rem;font-weight:300}.message{margin-bottom:1rem;padding:1rem;color:rgba(0,0,0,0.54);background-color:rgba(0,0,0,0.05)}.title{margin-bottom:0}.container{max-width:38rem;padding-left:1rem;padding-right:1rem;margin-left:auto;margin-right:auto}.content{padding-top:2rem;padding-bottom:2rem}@media (min-width: 58em){.content{max-width:38rem;margin-left:20rem;margin-right:2rem;padding-top:3rem;padding-bottom:3rem}}@media (min-width: 64em){.content{margin-left:22rem;margin-right:4rem;padding-top:3rem;padding-bottom:3rem}}@media not print{.print-resume-intro{display:none}}@media print{html{font-size:12px}.content{max-width:100%;margin:0rem 3rem;padding:0}.sidebar,.web-resume-intro{display:none}}.post,.page{margin-bottom:2em}.post-title,.post-title a,.page-title{font-weight:400;color:rgba(0,0,0,0.87);-webkit-transition:color 250ms ease;-moz-transition:color 250ms ease;-ms-transition:color 250ms ease;-o-transition:color 250ms ease;transition:color 250ms ease}.post-title a:hover,.post-title a:focus{color:rgba(33,150,243,0.87)}.post-title,.page-title{margin-top:0}.post-date{display:block;margin-top:-.5rem;margin-bottom:1rem;color:rgba(0,0,0,0.54)}.coffee{font-weight:400}.related{padding-top:1rem;font-weight:400;border-top:1px solid rgba(0,0,0,0.12)}.related-posts{padding-left:0;list-style:none}.related-posts h3{margin-top:0}.related-posts li small{font-weight:300;font-size:75%;color:rgba(0,0,0,0.54)}.project{margin-top:1rem;margin-bottom:1.5rem}.project-title a{font-weight:400}.sidebar{text-align:center;padding:1rem 1rem;color:rgba(255,255,255,0.54);background-color:#000}.logo{height:5rem;display:block;margin:0 auto 1rem}@media (min-width: 58em){.sidebar{position:fixed;top:0;left:0;bottom:0;width:18rem;text-align:left}.logo{height:15rem;margin-left:0}}.sidebar-about h1 a{margin-top:0}.sidebar a{color:rgba(255,255,255,0.87);-webkit-transition:color 250ms ease;-moz-transition:color 250ms ease;-ms-transition:color 250ms ease;-o-transition:color 250ms ease;transition:color 250ms ease}.sidebar a:hover,.sidebar a:focus{color:#fff}.sidebar-nav{margin-bottom:1rem}.sidebar-nav-item{display:block;line-height:1.75}.sidebar-nav-item.active{font-weight:400}@media (min-width: 58em){.sidebar-sticky{position:absolute;right:1rem;bottom:1rem;left:1rem}}.tagline{display:none}@media (min-width: 58rem){.tagline{display:block}}#menu-icon{display:none}.collapsable{display:none;padding-top:0.5rem}input[type=checkbox]:checked ~ .collapsable{display:block}input[type=checkbox] ~ .menu-label:after{content:"Menu"}input[type=checkbox]:checked ~ .menu-label:after{content:"Collapse"}@media (min-width: 58rem){.menu-label{display:none}.collapsable{display:block;padding-top:inherit}}.copyright{display:none}@media (min-width: 58rem){.copyright{font-size:0.75em;font-weight:100;display:block}}.blue-grey-theme .sidebar{background-color:#607d8b}.blue-grey-theme .post-title a,.blue-grey-theme .project-title a,.blue-grey-theme .related-posts a{color:rgba(96,125,139,0.87);-webkit-transition:color 250ms ease;-moz-transition:color 250ms ease;-ms-transition:color 250ms ease;-o-transition:color 250ms ease;transition:color 250ms ease}.blue-grey-theme .post-title a:hover,.blue-grey-theme .post-title a:focus,.blue-grey-theme .project-title a:hover,.blue-grey-theme .project-title a:focus,.blue-grey-theme .related-posts a:hover,.blue-grey-theme .related-posts a:focus{color:rgba(43,90,172,0.87)}.highlight{margin-bottom:1rem;border-radius:4px}.highlight pre{margin-bottom:0}.highlight .hll{background-color:#ffc}.highlight .c{color:#408080}.highlight .err{border:1px solid red}.highlight .k{color:#008000;font-weight:700}.highlight .o{color:#666}.highlight .cm{color:#408080;font-style:italic}.highlight .cp{color:#BC7A00}.highlight .c1{color:#408080;font-style:italic}.highlight .cs{color:#408080;font-style:italic}.highlight .gd{color:#A00000}.highlight .ge{font-style:italic}.highlight .gr{color:red}.highlight .gh{color:#000080;font-weight:700}.highlight .gi{color:#00A000}.highlight .go{color:gray}.highlight .gp{color:#000080;font-weight:700}.highlight .gs{font-weight:700}.highlight .gu{color:#800080;font-weight:700}.highlight .gt{color:#0040D0}.highlight .kc{color:#008000;font-weight:700}.highlight .kd{color:#008000;font-weight:700}.highlight .kn{color:#008000;font-weight:700}.highlight .kp{color:green}.highlight .kr{color:#008000;font-weight:700}.highlight .kt{color:#B00040}.highlight .m{color:#666}.highlight .s{color:#BA2121}.highlight .na{color:#7D9029}.highlight .nb{color:green}.highlight .nc{color:#0000FF;font-weight:700}.highlight .no{color:#800}.highlight .nd{color:#a2f}.highlight .ni{color:#999999;font-weight:700}.highlight .ne{color:#D2413A;font-weight:700}.highlight .nf{color:blue}.highlight .nl{color:#A0A000}.highlight .nn{color:#0000FF;font-weight:700}.highlight .nt{color:#008000;font-weight:700}.highlight .nv{color:#19177C}.highlight .ow{color:#AA22FF;font-weight:700}.highlight .w{color:#bbb}.highlight .mf{color:#666}.highlight .mh{color:#666}.highlight .mi{color:#666}.highlight .mo{color:#666}.highlight .sb{color:#BA2121}.highlight .sc{color:#BA2121}.highlight .sd{color:#BA2121;font-style:italic}.highlight .s2{color:#BA2121}.highlight .se{color:#BB6622;font-weight:700}.highlight .sh{color:#BA2121}.highlight .si{color:#BB6688;font-weight:700}.highlight .sx{color:green}.highlight .sr{color:#b68}.highlight .s1{color:#BA2121}.highlight .ss{color:#19177C}.highlight .bp{color:green}.highlight .vc{color:#19177C}.highlight .vg{color:#19177C}.highlight .vi{color:#19177C}.highlight .il{color:#666}        </style>

        <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/manifest.json">
        <meta name="msapplication-TileColor" content="#607d8b">
        <meta name="msapplication-TileImage" content="/mstile-144x144.png">
        <meta name="theme-color" content="#607d8b">

        <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-33031883-4', 'auto');

            ga('send', 'pageview', {
                page: location.pathname + location.search
            });
        </script>
    </head>

    <body class="blue-grey-theme">
        <div class="sidebar">
            <div class="container sidebar-sticky">
                <div class="sidebar-about">
                    <h1>
                        <a href="/">
<svg class="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 350" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M200 305L200 260C200 227.2 185.7 197.8 163 177.7 185.6 159.4 200 131.4 200 100 200 44.8 155.2 0 100 0L50 0 0 0 0 25 0 50 100 50C127.6 50 150 72.4 150 100 150 127.6 127.6 150 100 150L0 150 0 200 95 200C125.4 200 150 224.6 150 255L150 345C150 346.7 149.9 348.4 149.8 350L174.9 350 200 350 200 305 200 305ZM0 150L50 150 50 200 0 200 0 150Z" fill="#FFFFFF" opacity="0.9"/></g></svg>                        </a>
                    </h1>
                    <p class="tagline lead">Renzo Lucioni's personal website and portfolio.</p>
                </div>

                <input type="checkbox" id="menu-icon">
                <label class="menu-label" for="menu-icon"></label>

                <div class="collapsable">
                    <nav class="sidebar-nav">
                        <a class="sidebar-nav-item" href="/">Home</a>

                        <a class="sidebar-nav-item" href="/about">About</a>

                        <a class="sidebar-nav-item" href="/projects">Projects</a>

                        <a class="sidebar-nav-item profile outbound" href="https://github.com/rlucioni">GitHub</a>
                    </nav>
                </div>

                <p class="copyright">&copy; 2013&ndash;2018 Renzo Lucioni</p>
            </div>
        </div>

        <div class="content container">
<div class="post">
    <h1 class="post-title">S3 Deployment with&nbsp;Travis</h1>
    <span class="post-date">August 17, 2016</span>
    <p>You can use Travis to quickly and easily deploy a static site to S3 and invalidate a corresponding CloudFront distribution. Here&#8217;s&nbsp;how.</p>
<h2>Assumptions</h2>
<p>I&#8217;m assuming you already have a static site set up on S3 and CloudFront. If you don&#8217;t and are interested in learning how, David Baumgold has a great <a href="https://www.davidbaumgold.com/tutorials/deploy-static-site-aws-s3-cloudfront/">tutorial for how to make a static site on S3 and CloudFront</a>.</p>
<p>I&#8217;m also assuming the source for your site is hosted publicly on GitHub so you can use Travis, a free continuous integration platform for GitHub&nbsp;projects.</p>
<h2><span class="caps">IAM</span>&nbsp;User</h2>
<p>Start by making <span class="caps">AWS</span> credentials for Travis. Do this by creating an <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html"><span class="caps">IAM</span></a> user. From the <span class="caps">AWS</span> Management Console, navigate to the &#8220;Security Credentials&#8221;&nbsp;page.</p>
<p><img alt="Navigating AWS menu to the security credentials page" src="/images/aws-security-credentials-menu.png"></p>
<p>You may be presented with a modal encouraging you to create <span class="caps">IAM</span> users. Dismiss it by clicking &#8220;Continue to Security&nbsp;Credentials.&#8221;</p>
<p><img alt="Security credentials modal encouraging you to create IAM users" src="/images/aws-security-credentials-modal.png"></p>
<p>In the sidebar, navigate to&nbsp;&#8220;Users.&#8221;</p>
<p><img alt="Link in the security credentials sidebar to IAM users section" src="/images/aws-security-credentials-sidebar.png"></p>
<p>Click &#8220;Create New&nbsp;Users.&#8221;</p>
<p><img alt="New user creation button" src="/images/create-iam-users.png"></p>
<p>Enter a username for your Travis user and click &#8220;Create&#8221; in the lower right. I use the name &#8220;travis&#8221; so it&#8217;s clear what the user is&nbsp;for.</p>
<p><img alt="New user creation form" src="/images/iam-user-creation-form.png"></p>
<p>The next page will display security credentials for your new user, initially collapsed. These are important, and are only displayed once. If you lose them, you&#8217;ll need to generate new credentials. Keep them somewhere safe. We&#8217;ll return to them&nbsp;shortly.</p>
<p><img alt="Credentials shown once for a new user" src="/images/iam-user-credentials.png"></p>
<p>Once you&#8217;ve saved a copy of your user&#8217;s credentials, close the page using the link in the bottom&nbsp;right.</p>
<p>Now you need to grant your newly-created <span class="caps">IAM</span> user permission to access S3 (so it can upload files) and permission to access CloudFront (so it can invalidate distributions). This approach follows the principle of <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">least privilege</a>. In other words, you only grant this user the smallest set permissions necessary for it to do its&nbsp;job.</p>
<p>Click on the row for your <span class="caps">IAM</span> user in the listing, highlighted in blue&nbsp;below.</p>
<p><img alt="Row for new user selected" src="/images/iam-user-listing.png"></p>
<p>Select the &#8220;Permissions&#8221; tab, then click &#8220;Attach&nbsp;Policy.&#8221;</p>
<p><img alt="User permissions tab" src="/images/iam-user-permissions-empty.png"></p>
<p>Use the filter in the form that follows to select the &#8220;AmazonS3FullAccess&#8221; and &#8220;CloudFrontFullAccess&#8221; policies, checking the boxes next to each. Then click &#8220;Attach Policy&#8221; in the bottom right. If you did it correctly, you should see the&nbsp;following:</p>
<p><img alt="User permissions tab, with policies attached" src="/images/iam-user-permissions-attached.png"></p>
<p>Your <span class="caps">IAM</span> user is now ready to go! Next, you&#8217;ll configure&nbsp;Travis.</p>
<h2>Travis Repo&nbsp;Settings</h2>
<p>Navigate to your Travis profile page at https://travis-ci.org/profile/{your GitHub username}. In the list of public repositories, make sure Travis is enabled for the repo containing the source for your&nbsp;site.</p>
<p><img alt="Travis enabled for repo" src="/images/travis-repo-enabled.png"></p>
<p>Click the gear icon next to the repo name to view settings for the repo. General settings should appear as&nbsp;follows:</p>
<p><img alt="Travis general settings" src="/images/travis-general-settings.png"></p>
<p>Now define the following environment variables which your builds will be able to access. When doing this, make sure that the &#8220;Display value in build log&#8221; toggle is off for each new variable. You don&#8217;t want to leak sensitive information into your build&nbsp;logs.</p>
<p><img alt="Travis environment variables" src="/images/travis-environment-variables.png"></p>
<p>The names of the <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>, and <code>AWS_DEFAULT_REGION</code> variables are important. These are used to configure the <a href="https://pypi.python.org/pypi/awscli"><span class="caps">AWS</span> <span class="caps">CLI</span></a>, a Python package you&#8217;ll use to invalidate CloudFront&nbsp;distributions.</p>
<p>Set <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> using the security credentials for your <span class="caps">IAM</span> user. Set <code>AWS_DEFAULT_REGION</code> to <code>us-east-1</code> for the <span class="caps">US</span> East (N. Virginia) region. This is <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#cf_region">required</a> in order to submit requests to CloudFront programmatically. Finally, set <code>CLOUDFRONT_DISTRIBUTION_ID</code> to the <span class="caps">ID</span> of the CloudFront distribution whose origin is the S3 bucket hosting your&nbsp;site.</p>
<p>You&#8217;re halfway to configuring Travis for deployment. The last step is the addition or modification of a <code>.travis.yml</code> file.</p>
<h2>.travis.yml</h2>
<p>Travis uses a <code>.travis.yml</code> file at the root of your repository to learn about how you want your builds run. Let&#8217;s break down the options you need to define for S3 deployment and CloudFront invalidation. For a working example, see <a href="https://github.com/rlucioni/blog/blob/master/.travis.yml">my .travis.yml</a>. Some of these options are also explained in Travis&#8217; S3 deployment <a href="https://docs.travis-ci.com/user/deployment/s3">documentation</a>.</p>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">language</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="l l-Scalar l-Scalar-Plain">python</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="s">&quot;3.5&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">cache</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">pip</span>
<span class="l l-Scalar l-Scalar-Plain">install</span><span class="p p-Indicator">:</span>
  <span class="c1"># Install any dependencies required for building your site here.</span>
  <span class="c1"># `awscli` is required for invalidation of CloudFront distributions.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pip install awscli</span>
<span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span>
  <span class="c1"># Build your site (e.g., HTML, CSS, JS) here.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">make build</span>
<span class="l l-Scalar l-Scalar-Plain">deploy</span><span class="p p-Indicator">:</span>
  <span class="c1"># Control deployment by setting a value for `on`. Setting the `branch`</span>
  <span class="c1"># option to `master` means Travis will only attempt a deployment on</span>
  <span class="c1"># builds of your repo&#39;s master branch (e.g., after you merge a PR).</span>
  <span class="l l-Scalar l-Scalar-Plain">on</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">branch</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">master</span>
  <span class="l l-Scalar l-Scalar-Plain">provider</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">s3</span>
  <span class="c1"># You can refer to environment variables from Travis repo settings!</span>
  <span class="l l-Scalar l-Scalar-Plain">access_key_id</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$AWS_ACCESS_KEY_ID</span>
  <span class="l l-Scalar l-Scalar-Plain">secret_access_key</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">$AWS_SECRET_ACCESS_KEY</span>
  <span class="c1"># Name of the S3 bucket to which your site should be uploaded.</span>
  <span class="l l-Scalar l-Scalar-Plain">bucket</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">renzo.lucioni.xyz</span>
  <span class="c1"># Prevent Travis from deleting your built site so it can be uploaded.</span>
  <span class="l l-Scalar l-Scalar-Plain">skip_cleanup</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="c1"># Path to a directory containing your built site.</span>
  <span class="l l-Scalar l-Scalar-Plain">local_dir</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">build</span>
  <span class="c1"># Set the Cache-Control header.</span>
  <span class="l l-Scalar l-Scalar-Plain">cache_control</span><span class="p p-Indicator">:</span> <span class="s">&quot;max-age=21600&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">after_deploy</span><span class="p p-Indicator">:</span>
  <span class="c1"># Allow `awscli` to make requests to CloudFront.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">aws configure set preview.cloudfront true</span>
  <span class="c1"># Invalidate every object in the targeted distribution.</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">aws cloudfront create-invalidation --distribution-id $CLOUDFRONT_DISTRIBUTION_ID --paths &quot;/*&quot;</span>
</pre></div>


<p>Once you define your own <code>.travis.yml</code>, commit it and push it to GitHub. Since a <code>.travis.yml</code> file is present, Travis will start a build for your commit. If it succeeds, your site will be uploaded to&nbsp;S3!</p>
<p>I&#8217;ll end with a few additional&nbsp;notes:</p>
<ol>
<li>
<p>Steer clear of the <a href="https://docs.travis-ci.com/user/deployment/s3#Setting-Content-Encoding-header"><code>detect_encoding</code></a> option. CloudFront won&#8217;t <a href="http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/ServingCompressedFiles.html#compressed-content-cloudfront">compress objects</a> with a <code>Content-Encoding</code> header.</p>
</li>
<li>
<p>Use of the <span class="caps">AWS</span> <span class="caps">CLI</span>&#8217;s <code>create-invalidation</code> command is documented <a href="http://docs.aws.amazon.com/cli/latest/reference/cloudfront/create-invalidation.html">here</a>.</p>
</li>
<li>
<p>The first 1,000 CloudFront invalidation paths you submit per month are free. According to CloudFront <a href="http://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Invalidation.html#PayingForInvalidation">documentation</a>, &#8220;a path that includes the * wildcard counts as one path even if it causes CloudFront to invalidate thousands of objects.&#8221; This includes <code>/*</code>, which invalidates every object in the&nbsp;distribution.</p>
</li>
<li>
<p>Prevent Travis from deploying a commit by adding <code>[ci skip]</code> anywhere in your commit&nbsp;message.</p>
</li>
</ol>
<p>I hope this was useful! If you see something wrong, let me know by opening an issue on <a href="https://github.com/rlucioni/blog">GitHub</a>.</p>
    <span class="coffee">
        Was this helpful? <a class="outbound" href="https://www.paypal.me/rlucioni/3">Buy me a coffee!</a>
    </span>
</div>

<div class="related">
    <h2>Related Posts</h2>
    <ul class="related-posts">
        <li>
            <h3>
                <a href="/serverless-slash-commands-with-python/">
                    Serverless Slash Commands with&nbsp;Python
                    <small>March 5, 2018</small>
                </a>
            </h3>
        </li>
        <li>
            <h3>
                <a href="/mail-forwarding-with-mailgun/">
                    Mail Forwarding with&nbsp;Mailgun
                    <small>August 18, 2016</small>
                </a>
            </h3>
        </li>
    </ul>
</div>
        </div>

        <script>
            const pdfResumeLink = document.getElementById('pdf-resume-link');
            if (pdfResumeLink) {
                pdfResumeLink.addEventListener('click', event => {
                    ga('send', 'pageview', {
                        page: event.target.pathname,
                        transport: 'beacon'
                    });
                });
            }

            const outboundLinks = document.getElementsByClassName('outbound');
            for (const link of outboundLinks) {
                link.addEventListener('click', event => {
                    ga('send', 'event', {
                        eventCategory: 'outbound',
                        eventAction: 'click',
                        eventLabel: event.target.href,
                        transport: 'beacon'
                    });
                });
            }

            const emailLink = document.getElementById('email-link');
            if (emailLink) {
                emailLink.href = 'mailto:renzo@lucioni.xyz';
                emailLink.innerHTML = 'renzo@lucioni.xyz';
            }

        </script>
    </body>
</html>