{# Some of the below generates HTML originally Copyright (c) 2013 Mark Otto. #}
<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        {# Enable responsiveness on mobile devices. #}
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{% block title %}{{ AUTHOR }}{% endblock title %}</title>
        <meta name="description" content="{% block description %}{{ SITE_DESCRIPTION }}{% endblock description %}">

        <link rel="stylesheet" href="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/css/{{ CSS_FILE }}" />

        {# Favicon stuff; ugly, but apparently necessary. #}
        <link rel="apple-touch-icon" sizes="57x57" href="{{ SITEURL }}/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="{{ SITEURL }}/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="{{ SITEURL }}/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="{{ SITEURL }}/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="{{ SITEURL }}/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="{{ SITEURL }}/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="{{ SITEURL }}/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="{{ SITEURL }}/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="{{ SITEURL }}/apple-touch-icon-180x180.png">
        <link rel="icon" type="image/png" href="{{ SITEURL }}/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="{{ SITEURL }}/android-chrome-192x192.png" sizes="192x192">
        <link rel="icon" type="image/png" href="{{ SITEURL }}/favicon-96x96.png" sizes="96x96">
        <link rel="icon" type="image/png" href="{{ SITEURL }}/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="{{ SITEURL }}/manifest.json">
        <meta name="msapplication-TileColor" content="#607d8b">
        <meta name="msapplication-TileImage" content="{{ SITEURL }}/mstile-144x144.png">
        <meta name="theme-color" content="#607d8b">

        {% if GOOGLE_ANALYTICS_KEY and not INSTANT_CLICK %}
        <script async src='//www.google-analytics.com/analytics.js'></script>
        <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', '{{ GOOGLE_ANALYTICS_KEY }}', 'auto');
            ga('send', 'pageview');
        </script>
        {% endif %}
    </head>

    <body class="blue-grey-theme">
        {# Begin sidebar #} 
        {# We add the sidebar here instead of including it as a partial template so that active menu item can be assigned in child templates. #}
        {# For more on this, see http://goo.gl/5b5XP3. #}
        <div class="sidebar">
            <div class="container sidebar-sticky">
                <div class="sidebar-about">
                    <h1>
                        <a href="{{ SITEURL }}/">
                            <img class="logo" src="{{ SITEURL }}/images/logo.svg">
                        </a>
                    </h1>
                    <p class="lead">{{ SITE_DESCRIPTION }}</p>
                </div>

                <nav class="sidebar-nav">
                    <a class="sidebar-nav-item{% if active_item == "index"%} active{% endif %}" href="{{ SITEURL }}/">Home</a>

                    <a class="sidebar-nav-item{% if active_item == "projects"%} active{% endif %}" href="{{ SITEURL }}/projects/">Projects</a>

                    <a class="sidebar-nav-item{% if active_item == "about"%} active{% endif %}" href="{{ SITEURL }}/about/">About</a>

                    <a class="sidebar-nav-item profile" href="{{ GITHUB_URL }}" data-profile-id="github">GitHub</a>
                </nav>

                <p>&copy; 2013&ndash;{{ CURRENT_TIME|strftime('%Y') }} Renzo Lucioni</p>
            </div>
        </div>
        {# End sidebar #}

        <div class="content container">
            {% block content %}
            {% endblock content %}
        </div>

        {% if INSTANT_CLICK %}
        <script src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/js/instantclick.min.js" data-no-instant></script>
        {% if FAST_CLICK %}
        <script src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/js/fastclick.min.js" data-no-instant></script>
        {% endif %}
        <script data-no-instant>
            {% if GOOGLE_ANALYTICS_KEY %}
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            {# Create a tracker object for the specified web property. #}
            ga('create', '{{ GOOGLE_ANALYTICS_KEY }}', 'auto');
            {% endif %}

            {% if SEGMENT_KEY %}
            {# Load Segment library, analytics.js. #}
            !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.1";
            analytics.load('{{ SEGMENT_KEY }}');
            }}();
            {% endif %}

            InstantClick.on('change', function() {
                {% if GOOGLE_ANALYTICS_KEY %}
                {# On page load, track a page view. #}
                ga('send', 'pageview', location.pathname + location.search);
                {% endif %}

                {% if SEGMENT_KEY %}
                {# On page load, identify profile, project, and resume links. #}
                var profileLinks = document.querySelectorAll('a.profile'),
                    projectLinks = document.querySelectorAll('.project a'),
                    resumeLinks = document.querySelectorAll('a.resume');

                {# Each profile link element has a data attribute containing a profile ID. #}
                analytics.trackLink(profileLinks, 'profile.viewed', function(link) {
                    return {id: link.dataset.profileId}
                });

                {# Each project link element has a data attribute containing a project ID. #}
                analytics.trackLink(projectLinks, 'project.viewed', function(link) {
                    return {id: link.dataset.projectId}
                });

                {# Each resume link element has a data attribute containing a resume ID. #}
                analytics.trackLink(resumeLinks, function(link) {
                    {% if GOOGLE_ANALYTICS_KEY %}
                    if (link.dataset.resumeId === 'pdf') {
                        {# Track a page view to Google Analytics before the PDF resume is viewed. #}
                        ga('send', 'pageview', '/pdfs/renzo-lucioni-resume.pdf');
                    }
                    {% endif %}
                    return 'resume.viewed'
                }, function(link) {
                    return {id: link.dataset.resumeId}
                });
                {% endif %}

                {% if FAST_CLICK %}
                FastClick.attach(document.body);
                {% endif %}
            });

            {# Preload if user hovers for more than 100ms #}
            InstantClick.init(100);
        </script>
        {% endif %}

        {% if SEGMENT_KEY and not INSTANT_CLICK %}
        <script>
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.1";
        analytics.load('{{ SEGMENT_KEY }}');
        }}();
        
        var profileLinks = document.querySelectorAll('a.profile'),
            projectLinks = document.querySelectorAll('.project a'),
            resumeLinks = document.querySelectorAll('a.resume');

        {# Each profile link element has a data attribute containing a profile ID. #}
        analytics.trackLink(profileLinks, 'profile.viewed', function(link) {
            return {id: link.dataset.profileId}
        });

        {# Each project link element has a data attribute containing a project ID. #}
        analytics.trackLink(projectLinks, 'project.viewed', function(link) {
            return {id: link.dataset.projectId}
        });

        {# Each resume link element has a data attribute containing a resume ID. #}
        analytics.trackLink(resumeLinks, function(link) {
            {% if GOOGLE_ANALYTICS_KEY %}
            if (link.dataset.resumeId === 'pdf') {
                {# Track a page view to Google Analytics before the PDF resume is viewed. #}
                ga('send', 'pageview', '/pdfs/renzo-lucioni-resume.pdf');
            }
            {% endif %}
            return 'resume.viewed'
        }, function(link) {
            return {id: link.dataset.resumeId}
        });
        </script>
        {% endif %}

        {% if FAST_CLICK and not INSTANT_CLICK %}
        <script src="{{ SITEURL }}/{{ THEME_STATIC_DIR }}/js/fastclick.min.js"></script>
        <script>
            if ('addEventListener' in document) {
                document.addEventListener('DOMContentLoaded', function() {
                    FastClick.attach(document.body);
                }, false);
            }
        </script>
        {% endif %}
    </body>
</html>
